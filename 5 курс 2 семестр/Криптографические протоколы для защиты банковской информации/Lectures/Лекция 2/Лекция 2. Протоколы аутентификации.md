>[!info] Определение
>**Протокол аутентификации** — криптографический протокол, в ходе которого одна сторона удостоверяется в идентичности другой стороны, вовлеченной в протокол, а также убеждается в том, что вторая сторона активна во время или непосредственно перед моментом приобретения доказательства.

Теоретические основы схем аутентификации были заложены в работах Симмонса.
В протоколе аутентификации участвуют две стороны:
1) претендент $Р$, или доказывающий;
2) проверяющий $V$.

Последний уже предполагает некоторую ожидаемую идентичность претендента, т.е. $Р$ не является для $V$ совсем незнакомым лицом — его только нужно правильно выбрать из списка известных лиц.

Цель $V$ заключается в том, чтобы подтвердить предполагаемую идентичность претендента, т.е. что он в самом деле является $Р$, а не кем-то иным.
Проверяющий на выходе протокола аутентификации должен либо принять претендента как аутентичного, либо отвергнуть его как не соответствующего заявленной идентичности.
Все схемы аутентификации, используемые на практике для обеспечения целостности банковской информации, основываются на теоретико-сложностных принципах. Для таких схем всегда существуют атаки, заведомо приводящие к успеху, но их реализация для стойких схем должна требовать (предположительно) практически невыполнимого объема вычислений.

# Требования к протоколу аутентификации
1) если $Р$ и $V$ являются честными, $V$ завершит протокол, приняв идентичность $Р$;
2) проверяющий $V$ не может повторно использовать протокол, совершенный с претендентом $Р$, для того, чтобы успешно деперсонифицировать $Р$ в протоколе с третьей стороной $М$;
3) вероятность того, что любая сторона $М$, отличная от претендента Р, проведя протокол и играя роль $Р$, может заставить проверяющего V завершить протокол с принятием идентичности $Р$, пренебрежимо мала;
4) предыдущие свойства остаются справедливыми, даже если между $Р$ и $V$ совершено большое, но полиномиально ограниченное число сеансов протокола, противник М участвовал в предыдущих сеансах выполнения протокола и несколько сеансов могли выполняться одновременно.

# Способы аутентификации
1. **«Субъект знает»** — претендент обладает некоторой информацией, которой нет у других субъектов компьютерной системы (паролями, цифровыми кодами, секретными ключами) и знание которой он демонстрирует в протоколах аутентификации.
2. **«Субъект обладает»** — претендент имеет некоторый физический предмет (магнитную карту, генератор паролей) который необходим для его участия в протоколе аутентификации и который выполняет для него криптографические преобразования информации.
3. **«Субъект есть»** — в протоколе проверяются некоторые признаки, характеризующие человеческую индивидуальность субъекта (биометрические признаки).

# Основные применения протоколов аутентификации
1. Содействие контролю доступа к ресурсам компьютерных систем.
2. Учет использования ресурсов компьютерной системы, распределение ключей криптографических систем и средств защиты информации.

# Протоколы с центром доверия
К данной категории схем аутентификации условно относятся те схемы, в которых открытые ключи всех абонентов хранятся в общедоступном сертифицированном справочнике. Для этого в системе необходим некоторый центр, пользующийся безусловным доверием всех абонентов (центр доверия), в обязанности которого входит ведение справочника.

Открытые ключи хранятся в справочнике вместе с соответствующими идентификаторами абонентов. Выполнение всякого протокола аутентификации начинается с предварительного шага: доказывающий (абонент, проходящий аутентификацию) посылает свои идентификатор и открытый ключ проверяющему (т.е. абоненту, проверяющему аутентичность доказывающего), а проверяющий устанавливает их подлинность, т.е. проверяет по справочнику подпись центра доверия под этой информацией. В дальнейшем в описаниях протоколов этот предварительный шаг опускается.

# Протокол аутентификации Фиата — Шамира (1986)
Это первый из предложенных протоколов аутентификации, основанный на доказательстве с нулевым разглашением знания.

>[!info] Предварительный этап
>Центр доверия выбирает два больших простых числа $р$ и $q$ (которые он держит в секрете) и публикует большое число $n=pq$, $n \geq 512$ бит.

>[!hint] Замечание
>Рекомендуется 1024 бита. Для упрощения вычислений, но не для повышения безопасности рекомендуется выбирать число Блюма $n=(4p+3)(4q+3)$

Далее сторона, которая будет выполнять в протоколе аутентификации роль претендента, выбирает свой секретный ключ $s$, причем $(s,n) = 1, 1 \leq n \leq n-1$
Открытый ключ $v = s^2 (\bmod n)$.
В конце предварительного этапа всем сторонам становятся известны величины:
1) $n$ — модуль схемы;
2) $v$ — открытый ключ претендента $Р$.

>[!info] Рабочий этап
>В цикле выполняются следующие действия:
>1) претендент $Р$ выбирает случайное число $r, r < n$, вычисляет $х = r^2$ и отправляет его проверяющему $V$;
>2) проверяющий вырабатывает случайный бит $e \in \{0,1\}$ и посылает его претенденту $Р$;
>3) если $е = 0$, то претендент $Р$ отправляет проверяющему $V$ число $y=r$, в противном случае $(e=1)$ он отправляет число $y=rs (\bmod n)$;
4) $V$ проверяет, что $y \neq 0$, если это условие выполнено, то проверяется равенство $y^2 \equiv xv^e (\bmod n)$ и в случае его выполнения доказательство проверяющим принимается.

>[!hint] Замечание
>Если $y=0$,то доказательство должно быть недействительным
из-за того, 0.

Действия (1) — (4) повторяются в цикле $t$ раз. Число $t$ называют **параметром безопасности протокола**.
Вероятность обмана претендентом проверяющего при выполнении цикла t раз равна $1/2^t$. Считается, что претендент $Р$ прошел аутентификацию, если проверка сравнения на шаге (4) во всех $t$ циклах завершилась с положительным результатом.
Стойкость протокола Фиата — Шамира основана на сложности извлечения квадратного корня по модулю $n$, когда неизвестно разложение $n$ на множители.

# Протокол Фейга — Фиата — Шамира
Данный протокол является усовершенствованным вариантом
протокола Фиата — Шамира. В нем уменьшается число раундов обмена между претендентом и проверяющим и сохранятся свойство нулевого разглашения знания.

>[!info] Предварительный этап
>Центр доверия выбирает число $n=pq \in Z$.
>Далее претендент выбирает свой секретный ключ в виде набора $k$ различных чисел $s_i$, где $(s_i, n)=1, 1 \leq s_i \leq n-1$
>Строка $v_i$, где $v_i=s_i^2 (\bmod n)$, принимается в качестве открытого ключа претендента $Р$.

>[!info] Рабочий этап
>В цикле $t$ раз выполняются следующие действия:
>1) претендент $Р$ выбирает случайное число $r (r < n)$, вычисляет $x=r^2 (\bmod n)$ и отправляет его проверяющему $V$;
>2) проверяющий вырабатывает случайную двоичную строку $\{e_i\}, e_i \in \{0,1\}$ и посылает его претенденту $Р$;
>3) претендент $Р$ вычисляет $$y=$$ перемножая только те $s_i$, которые соответствуют единичным битам вектора $e$, и посылает $y$ проверяющему V;
>4) V проверяет, что $$y^2 = x \cdot \prod_{i=1}^{k} s_i^{e_i}$$

>[!hint] Замечание
>В данном протоколе вероятность ошибки проверяющего в $t$ проходах цикла равна $1/2^{kt}$
>Авторы протокола рекомендовали выбирать $k=5, t = 4$.


# Протокол аутентификации Шнорра, 1989
Схема основана на сложности задачи дискретного логарифмирования.

>[!info] Предварительный этап
>Центр доверия выбирает и открыто публикует два простых числа ри q ((р— 1):q) и число а + 1: aq 1(modp).
>Далее выбирается случайное число s < q, становящееся секретным ключом претендента Р, и вычисляется открытый ключ v = a¯S(modp).

>[!info] Рабочий этап
>1) претендент Р выбирает случайное число r < q, вычисляет х ar(modp) и отправляет его проверяющему V;
>2) проверяющий вырабатывает случайное число е: — 1 и посылает его претенденту Р;
>3) претендент Р вычисляет у = r + se(modq) и посылает его проверяющему V;
>4) V проверяет, выполнено ли равенство х = aYve(modp).

Проверка аутентичности претендента Р основана на том, что в вычислениях на шаге (З) участвует его секретный ключ s, который проверяющий V получить не может вследствие вычислительной сложности задачи дискретного логарифмирования. Претендент считается прошедшим аутентификацию, если проверка сравнения на шаге (4) прошла с положительным результатом.
Безопасность протокола основана на величине параметра t.
Сложность вскрытия протокола составляет порядка 2t операций.
Авторы рекомендуют выбирать р 512 бит, q 140 бит, t 72 битам.
Свойство нулевого разглашения для схемы Шнорра строго не доказано.

# Протокол аутентификации Брикелла — Мак-Карли, 1990-1991
Является модификацией протокола Шнорра.
>[!info] Предварительный этап
>Центр доверия выбирает простые числа р, q, w: где К — параметр безопасности.
>Числа q и w являются секретными, остальные — открытыми.
>Далее претендент Р выбирает секретный ключ s < р и вычисляет открытый ключ v где 1(modp). а: aqz

>[!info] Рабочий этап
>1) претендент Р выбирает случайное число r < р, вычисляет х = ar(modp) и отправляет его проверяющему V;
>2) проверяющий вырабатывает случайное число е: — 1 и посылает его претенденту Р;
>3) претендент Р вычисляет у (r + se)(mod(p — 1)) и пересылает его проверяющему V;
>4) V проверяет выполнение равенства х aYve(modp).

>[!hint] Замечание
>Протокол дополнительно усложняет задачу противника: он должен уметь уже не только решать задачу дискретного логарифмирования, но и задачу факторизации числа (р — 1).
>Авторы рекомендуют выбирать К 140 бит, р 512 бит.

Все протоколы аутентификации, основанные на асимметричных алгоритмах, обладают одним интересным свойством — они стандартным образом могут быть преобразованы в схемы цифровой подписи.
Протоколы аутентификации и схемы цифровой подписи во многом аналогичны, но имеют и существенные различия, главные из которых заключаются в следующем:
1) в схемах цифровой подписи сообщение имеет время жизни — тем самым обеспечивается невозможность отказа от факта создания документа и возможность разрешения конфликтных ситуаций, связанных с принадлежностью цифровой подписи; в то же время в протоколах аутентификации проверка и принятие решений происходят немедленно, в режиме реального времени;
2) содержание сообщений, подписываемых цифровой подписью, может быть произвольным, в то время как в протоколах аутентификации содержание всех передаваемых сообщений фиксировано;
3) цифровая подпись служит для аутентификации сообщений, в то время как основная цель протокола аутентификации — аутентификация субъекта компьютерной системы (чаще всего это пользователь, взаимодействующий с системой через некоторую совокупность аппаратно-программных средств).